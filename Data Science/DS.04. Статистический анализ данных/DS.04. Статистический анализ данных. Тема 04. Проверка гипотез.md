## [DS.04. Статистический анализ данных. Тема 04. Проверка гипотез](https://practicum.yandex.ru/trainer/data-scientist/lesson/ee5bae08-bec7-468d-b697-b97ad14bcc1f/)

Проверка гипотез — статистический инструмент. Она позволяет судить о больших совокупностях по меньшим выборкам и делать предположения о параметрах распределения совокупностей.
-понимать, как центральная предельная теорема в ещё одной своей формулировке описывает выборочное распределение;
-применять логику проверки статистических гипотез;
-проверять гипотезу о равенстве среднего исследуемой генеральной совокупности заданному значению;
-проверять гипотезу о равенстве средних двух генеральных совокупностей.

### [Урок 2. Какие бывают выборки](https://practicum.yandex.ru/trainer/data-scientist/lesson/f5480037-dfd8-47c7-acb2-6460e7222f4b/)
В жизни редко встречается такая ситуация, когда мы свободно получаем и используем все нужные данные. Часто данных много и получить доступ к каждому их элементу технически сложно, долго и дорого. Поэтому о большом объёме данных, генеральной совокупности, судят по части — выборке.
Для анализа необязательно выгружать весь датасет с информацией по посещениям, который может оказаться огромным: достаточно взять небольшую, но репрезентативную часть данных.

 Главное свойство выборки — репрезентативность: способность адекватно отобразить всю генеральную совокупность.
Самый простой способ добиться репрезентативности — использовать случайную выборку. Случайность здесь означает, что для каждого элемента датасета шанс оказаться в выборке одинаков. Чтобы этого добиться, обычно используют генераторы случайных чисел.
Репрезентативность выборки не зависит от её размера, а только от того насколько аккуратно она набирается, избегая смещений в сторону каких-то отдельных групп внутри генеральной совокупности

`Тест:`
```
Фермер вырастил 618 гранатовых деревьев и записал урожайность каждого из них в таблицу. Стоит ли использовать случайную выборку, чтобы проанализировать эти данные?
Выборка тут не нужна!
Если есть возможность посчитать интересующие параметры по всем данным, так и нужно делать. Нет выборки репрезентативнее, чем вся генеральная совокупность, а в этом случае и данные уже есть, и их объём невелик.
```

Бывает, что генеральная совокупность состоит из страт — групп данных, различающихся по размеру и исследуемому параметру. Тогда исследовать данные лучше на основе стратифицированной выборки.
Если, допустим, вы изучаете поведение клиентов авиалиний, то надо помнить о такой группе как пассажиры бизнес-класса — их мало, но при этом покупательское поведение у них сильно отличается от общей массы. Случайная выборка в такой ситуации может подвести, если данных из этой страты в неё попадёт слишком много или слишком мало. Чтобы верно проанализировать необходимые категории пассажиров, воспользуйтесь стратифицированной выборкой: возьмите пропорциональные случайные выборки из всех страт, а потом соедините их между собой.
`Тест:`
```
В какой из этих ситуаций понадобится стратифицированная выборка?
исследуемая переменная: траты на социальный пакет; генеральная совокупность: сотрудники крупной корпорации.
Условия как оплаты труда, так и трат на социальный пакет могут отличаться среди разных отделов. Лучше убедиться, что все они будут представлены одинаково хорошо.
```
`Тест:`
```
Компания, занимающаяся перевозками по морю, решила выяснить, сколько весит груз после того, как его окончательно упакуют в порту. Поскольку взвешивание затягивает процесс погрузки, то узнать вес всех грузов, уходящих на этой неделе из трёх портов, не получится. Рабочие успеют взвесить только тридцать грузов.
Как компании лучше поступить?
Взять в каждом порту такое количество случайно выбранных грузов, чтобы доля этого числа от 30 была близка к доле грузов в этом порту от общего числа грузов компании.
Именно так и стоит составлять стратифицированную выборку. Каждый порт может делать разный вклад в общее количество грузов, и это желательно учесть.
```
`Тест:`
```
На фабрике экопродуктов проращивают зёрна пшеницы. Чтобы выбрать для них правильную упаковку, нужно знать среднюю длину ростков. В каком случае результат будет точнее?
Оба варианта ответа подходят.
Действительно, в обоих случаях возьмут 250 случайно выбранных ростков и усреднят их длину, неважно, с подсчётом промежуточных средних или нет.
```

Стоит помнить, что выборка — это скорее инструмент, позволяющий сделать вывод о генеральной совокупности тогда, когда вся она недоступна. Если размер генеральной совокупности невелик и есть полный доступ к ней, конечно, лучше использовать все данные, а не только их часть.

### [Урок 3. Оценка параметров генеральной совокупности по выборке](https://practicum.yandex.ru/trainer/data-scientist/lesson/6892fa35-a44a-4585-895b-e46dd8093524/)

Выборка нужна только для одной цели: сделать вывод о статистических параметрах генеральной совокупности — числах, которые характеризуют всю совокупность.
Для этого в статистике существует два типа оценок:
Интервальная — оценка параметра доверительным интервалом. Чтобы оценить параметр интервально, находят диапазон значений, в который этот параметр должен попасть.
Точечная — оценка параметра одним числом. Для точечной оценки находят число, близкое к значению параметра.
**Точечная оценка** — попытка найти приближённое значение параметра одним числом, то есть точкой на числовой оси. Её используют для разных параметров. Самые распространённые примеры — выборочное среднее и выборочная дисперсия, рассчитанные по выборочным данным.
У слова «статистика» есть несколько значений:
математическая дисциплина;
термин: любая функция, рассчитанная только на данных выборки.
Выборочное среднее и выборочная дисперсия — статистики: они рассчитываются на выборке. А σ/2 (sigma ) — нет. Стандартное отклонение генеральной совокупности, обозначаемое \sigmaσ, — это параметр генеральной совокупности. Узнать его по выборке невозможно, можно только оценить.
X — выборочное среднее
Xˉ/√D​ — выборочное среднее, делённое на выборочное стандартное отклонение
**Поправка Бесселя**
Точечную оценку ищут с единственной целью: найти число, как можно более близкое к оцениваемому параметру.
Доказанный математический факт: если выборка взята случайным образом и в ней больше 30 чисел, то выборочное среднее и дисперсия близки к реальным среднему и дисперсии генеральной совокупности.
Важно, что для выборочной дисперсии формула отличается от обычного расчёта дисперсии для заданного набора чисел. В её знаменателе стоит не n, а n−1.
Деление на n-1 вместо n называется поправкой Бесселя:
![[Pasted image 20221006090306.png]]
^ «Крышечка» над сигмой в квадрате означает, что для этого параметра — дисперсии генеральной совокупности — находят оценку. Это альтернатива латинице, показывающая, что это оценённое, а не истинное значение.
Точечная оценка называется несмещённой, если математическое ожидание статистики равно оцениваемому параметру. Термин «математическое ожидание» здесь применим, потому что любая статистика — случайная величина. У неё могут быть разные значения для разных выборок.
Выборочное среднее — это несмещённая оценка для истинного среднего генеральной совокупности, а выборочная дисперсия с поправкой Бесселя — для истинной дисперсии. Значит, по закону больших чисел, чем больше данных собрано, тем ближе выборочное среднее и выборочная дисперсия с поправкой Бесселя к истинным среднему и дисперсии генеральной совокупности.

В дальнейшем будут использоваться понятия «выборочная дисперсия» и «выборочное стандартное отклонение» для обозначения несмещённых оценок, то есть рассчитанных с поправкой Бесселя.
`Тест:`
```
Допустим, мы оцениваем некоторый параметр λ (lambda) с помощью статистики l, рассчитывая её на выборке размера n. У чего тут есть математическое ожидание?
Только у l
Статистика — это случайная величина. Только у неё тут есть математическое ожидание.
```
Смещение может возникнуть в двух случаях:
Формула для оценки параметра не является несмещённой оценкой для него. Например, дисперсия без поправки Бесселя — смещённая оценка.
Выборка нерепрезентативна. Поэтому оценки, посчитанные на ней, смещаются: они отклоняются от истинного значения параметра в ту или иную сторону. В этом случае правильно подобранная формула не поможет.
`Тест:`
```
Студентка Маша готовится к семинару в университете. Ей удалось получить репрезентативную выборку для её расчёта. Но Маша ошиблась с формулой: математическое ожидание выбранной ей статистики не равно нужному параметру. Возможно ли, что Маша получит оценку этого параметра, которая будет строго равна его истинному значению?
Возможно, всегда может повезти, но рассчитывать на удачу не стоит. Особенно, если выборка большая: чем больше выборка, тем ближе мы попадём к математическому ожиданию статистики. Если оценка смещённая, это не будет истинным значением параметра.
```
`Тест:`
```
Отсутствие смещения выборки означает:
Способ получения выборочных значений удачен: выборка репрезентирует всю генеральную совокупность.
Осталось только набрать достаточно данных, чтобы получить очень близкие к реальным значениям. По меньшей мере можно взять 30, а лучше 50 значений.
```
`Тест:`
```
В чём отличие точечной оценки от интервальной?
Используя точечную оценку, числом оценивают интересующий параметр генеральной совокупности. При интервальной — параметр оценивается интервалом.
Верно, в обоих случаях оценивается параметр генеральной совокупности — его число.
```
случайные выборки это самый простой и распространённый способ добиться репрезентативности: соответствия параметров всей генеральной совокупности и куда меньшего набора данных — выборки.

### [Урок 4. Что такое выборочное распределение](https://practicum.yandex.ru/trainer/data-scientist/lesson/98972cae-e996-4d63-b9f2-b2711196e8ef/)

Вы уже знаете формулы числа сочетаний, важные для биномиального распределения. И понимаете, как ответить на вопрос, сколько разных выборок размера k можно взять из генеральной совокупности размера n:
![[Pasted image 20221006114924.png]]
Полученное число сочетаний из n по k растёт очень быстро, — даже быстрее, чем экспоненциальная функция.
```
➡️ размер генеральной совокупности: 100100  
размер выборки: 88  
сколько разных выборок такого размера: 186087894300186087894300 — выборок размера 8 из генеральной совокупности размера 100 можно взять в десятки раз больше, чем живёт людей на земле.

➡️ размер генеральной совокупности: 500500  
размер выборки: 2020  
сколько разных выборок такого размера: 2.6671985128374·10^{35} — в наблюдаемой вселенной не найдётся столько звёзд.
```
На этих примерах видно, что количество различных выборок размера k из генеральной совокупности размера m оказывается на порядки больше, чем оба эти числа.

Если взять все возможные выборки и на каждой посчитать статистику — например, выборочное среднее, — получится огромный набор чисел. На практике берут одну выборку и на ней считают статистику. В результате получается одно число из этого набора.
У этого набора значений статистики на всех возможных выборках нет своего специального названия, но важнее, что у него есть распределение — **выборочное распределение** этой статистики.
`Тест:`
```
В локальной сети компании «Паутинка» несколько тысяч серверов онлайн. Системный администратор выбрал из них сорок случайных серверов и измерил время ответа каждого из них в миллисекундах. Из получившихся сорока значений он рассчитал медиану.
Выборочным распределением будет называться:
Распределение медиан всех возможных наборов сорока серверов, выбранных из нескольких тысяч серверов онлайн.
Если взять все возможные выборки из сорока серверов и посчитать медианное время ответа для каждой из них, распределение полученного набора чисел называется выборочным распределением.
```
выборочное распределение — это распределение значений интересующей исследователя статистики на всех возможных выборках определённого размера, которые можно взять из некоторой генеральной совокупности.
Выборочное распределение нельзя построить в точности. Если исследователю доступны все возможные выборки, ему доступна вся генеральная совокупность, — брать выборку нет смысла.
Хоть это распределение недоступно, без него не получится проверить ни одну статистическую гипотезу.
`Тест:`
```
От чего будет зависеть выборочное распределение выборочного среднего для выборки размера n?
От n. Чем больше n, тем меньше будет дисперсия выборочного распределения выборочного среднего. Больше данных — точнее оценка.
```
Можно предположить, что реальные генеральные совокупности распределяются всевозможными способами. Из них берут выборки разного размера и на полученных данных считают разные статистики.
Кажется, что выборочное распределение принимает любой вид, поэтому предсказать его нельзя. Но для многих статистик доказано, что их выборочное распределение будет иметь предсказуемый вид.
```
 Выборочное распределение не зависит от распределения генеральной совокупности при условии, что исследуемая переменная имеет конечную дисперсию. В противном случае выборочный метод и вовсе неприменим. Поэтому принято по умолчанию предполагать дисперсию конечной. Считается, что бесконечная дисперсия — экзотический феномен, который можно проигнорировать.
```

### [Урок 5. ЦПТ, или самое важное утверждение о выборочном среднем](https://practicum.yandex.ru/trainer/data-scientist/lesson/f8ef6c3c-023a-4b26-a2e8-78843fa9053e/)

На практике необходимо понять, равны ли средние двух генеральных недоступных совокупностей. Делать вывод о равенстве нужно по выборкам, и для этого понадобятся не только выборочные средние, но и выборочные дисперсии, потому что разброс данных в совокупностях может повлиять на результат статистического теста. Если разброс данных большой, то небольшая разница между выборочными средними может быть простой случайностью. А если разброс маленький, то даже небольшая разница может означать существенное различие между средними.
Разберёмся, как устроена дисперсия выборочного среднего.
`Тест:`
```
Если есть полный доступ к двум генеральным совокупностям, нужно ли определять какое из их средних больше с помощью статистического теста?
Нет, ведь есть доступ к самим генеральным совокупностям.
Действительно, если вы хотите просто сравнить их средние, можно посчитать и сравнить. А вот чтобы сделать вывод о значимости разницы между ними, без статистического теста уже не обойтись.
```

`Тест:`
```
Почему нельзя просто взять выборки из генеральных совокупностей, найти их средние и сравнить эти два числа между собой?
Истинные средние генеральных совокупностей могут быть равны или очень близки, а разница между выборочными средними может случайно оказаться относительно большой.
Верно, статистический тест и нужен, чтобы оценить вероятность этого.
```

Можно взять много разных выборок одинакового размера из одной и той же генеральной совокупности и для каждой посчитать среднее. Множество всех таких средних значений выборок фиксированного размера, взятых из одной генеральной совокупности, называется выборочным средним. То есть выборочное среднее — это не число, а случайная величина.

Одна из формулировок центральной предельной теоремы (сокр. ЦПТ) звучит так: если в выборке достаточно наблюдений, выборочное среднее распределено нормально вокруг среднего генеральной совокупности. Генеральная совокупность может быть распределена как угодно: датасет из средних значений выборок всё равно будет нормально распределён вокруг среднего всей совокупности.
![image|240](https://pictures.s3.yandex.net/resources/__1627994966.jpg)
Допустим, на какую-то переменную влияет множество небольших факторов. Если этих факторов так много, что учесть каждый невозможно, то в сумме они дадут нормальное распределение.
Классическая иллюстрация этого эффекта — доска Гальтона. Это устройство ещё в XIX веке придумал Фрэнсис Гальтон, учитель Карла Пирсона.
Множество случайностей меняют траектории падающих шариков, и в результате внизу собирается знакомый колокол.

Каким же будет разброс выборочного среднего как случайной величины? Зависит от размера выборки: чем она больше, тем меньше стандартное отклонение всех возможных выборочных средних. То есть чем больше выборку берём, тем точнее измеряем среднее генеральной совокупности.

Стандартное отклонение выборочного среднего называется стандартной ошибкой и находится по формуле:
E.S.E. = S /√n
Е.S.E. (от англ. estimated standard error) — «оценённая стандартная ошибка». «Оценённая», потому что мы можем оценить ошибку только по имеющейся выборке.
Формула Е.S.E. состоит из двух значений:
-S — стандартное отклонение выборки, которым оценивается стандартное отклонение генеральной совокупности.
-n — размер выборки. Раз корень из n стоит в знаменателе, значит, стандартная ошибка уменьшается с увеличением размера выборки.
Эта формула встроена в готовые методы Python и обычно не применяется сама по себе.

Центральная предельная теорема применительно к выборочному среднему говорит о том, что:
по выборочному среднему можно судить о среднем генеральной совокупности, причём чем больше выборка, тем точнее — это работает для генеральной совокупности, распределённой каким угодно образом.
```
`Тест:`
```
Центральная предельная теорема применительно к выборочному среднему говорит о том, что:
выборочные средние нормально распределены вокруг значения, точно равного среднему генеральной совокупности;
```

### [Урок 6. Формулирование гипотез](https://practicum.yandex.ru/trainer/data-scientist/lesson/df028c26-4d57-45dd-8b4f-8dced0a86d9c/)

Никакие экспериментально полученные данные не подтвердят гипотезу. Это фундаментальное ограничение. При условии, что гипотеза верна, данные могут лишь не противоречить ей или, наоборот, показывать очень маловероятные результаты.
Но и в том, и в другом случае нет оснований утверждать, что выдвинутая гипотеза доказана.

```
Пример
Биологи изучают маршруты перелётов птиц редкого вида. Гипотеза в том, что они всегда летят вдоль рек. Учёные отловили случайным образом несколько десятков птиц, прикрепили датчики и отпустили. Все отслеженные маршруты оказались пролегающими вдоль рек.
Доказывает ли это гипотезу? Нет, потому что какие-то птицы, возможно, летают по-другому, а отследить маршруты всех птиц даже редкого вида чаще всего невозможно. Однако уверенность в том, что гипотеза верна, повысилась. Если несколько исследований покажут, что маршруты птиц проходят вдоль рек, а обратное не будет подтверждено экспериментально, это будет признано научным фактом.
💡 Ни в одном факте человечество не уверено на 100%. Просто не нашлось экспериментальных данных, которые бы его опровергли. Когда-нибудь могут найтись — и теорию придётся пересмотреть.
Исключение одно: абстрактные математические утверждения. При заданных предпосылках они точно верны.
```



