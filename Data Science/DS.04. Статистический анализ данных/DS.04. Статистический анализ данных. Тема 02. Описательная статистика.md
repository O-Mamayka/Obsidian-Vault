## [Тема 02. Статистический анализ данных. Описательная статистика](https://practicum.yandex.ru/learn/data-scientist/courses/e9979cd4-4254-441e-bcf5-866a72181e76/sprints/43485/topics/b84cb499-5c29-4248-9a03-d6f7db6ded70/lessons/391e5f37-8b51-4d7f-bd2b-eca17aea2b67/)
Количественная (численная) переменная принимает числовое значение в диапазоне 
Категориальная (качественная) переменная принимает значение из ограниченного набора
Непрерывная переменная количественная переменная, которая может принимать любое численное значение 
Дискретная переменная количественная переменная, которая может принимать строго определённые значения 
Плотность частоты величина, равная высоте столбца гистограммы, площадь которого отображает частоту непрерывной переменной 
Плотностная гистограмма гистограмма, использующая в качества переменнойстолбца плотность частоты 
Метрики локации данных характерные значения выборки, по значениям которых можно судить, где примерно расположен набор данных на числовой оси 
Алгебраическая метрика локации среднее значение 
Структурная метрика локации медиана
Дисперсия среднее значение квадрата отклонения случайной величины от её среднего значения.
Стандартное отклонение квадратный корень из дисперсии
Правило трёх сигм практически все значения (около 99%) находятся в промежутке
Скошенность ассиметричность датасета
Датасет с положительной скошенностью (скошенностью вправо) датасет, гистограмма значений которого ассиметрична: дополнительные значения находятся справа, со стороны положительного направления оси 
Датасет с отрицательной скошенностью (скошенностью влево) датасет, гистограмма значений которого ассиметрична: дополнительные значения находятся слева, со стороны отрицательного направления оси


**Цели:
- научиться выбирать оптимальные метрики для описания данных;
- оценивать дискретные и непрерывные величины при помощи гистограмм разных типов;
- делать выводы о данных по статистическим показателям;
- познакомиться с основами теории вероятностей;
- определять тип распределения, уметь рассчитать нормальное и биномиальное;
- научиться строить и проверять гипотезы.
- делать выводы о скошенности датасета по значениям среднего и медианы.



### Урок 2. Непрерывные и дискретные переменные

Количественные переменные бывают дискретные и непрерывные.
![variables|320x240](https://pictures.s3.yandex.net/resources/variables_1564077449.jpg)

Непрерывные переменные принимают любые численные значения. К примеру, время нахождения пользователя на сайте можно измерить с любой степенью точности: в минутах, секундах или микросекундах. 
Дискретные - Переменные, принимающие строго определённые значения, называют.

### [Урок 4. Гистограмма частот для непрерывной переменной](https://practicum.yandex.ru/trainer/data-scientist/lesson/034278e0-3eb6-4ab8-a272-e89777a706d3/task/6ff65188-1d52-4187-883b-56cc4876d215/?hideTheory=1)

Если мы не можем посчитать частоту для значений разной точности, можно разбить всю шкалу на интервалы и найти число значений в каждом.
Можно указывать не число корзин, а границы самих интервалов — их передают списком:

```
import pandas as pd
data = pd.Series([11, 20, 22, 31, 32, 33, 41, 42, 43, 44, 51, 52, 53, 54, 55, 61, 62, 63, 64, 65, 66, 71, 72, 73, 74, 75, 76, 77, 81, 82, 83, 84, 85, 86, 87, 88, 91, 92, 93, 94, 95, 96, 97, 98, 99])

data.hist(bins=4, alpha=0.5)  # строим гистограмму с 4 корзинами
data.hist(
    bins=[11, 20, 30, 40, 50, 60, 70, 80, 90, 99], alpha=0.7
)  # строим гистограмму с 9 корзинами, границы которых перечислены в списке 
```
![hist|320x240](https://pictures.s3.yandex.net/resources/_1_1564077679.png)

#### Урок 4. Задача 1

Изучите простую метрику — время оформления покупки.

```
import pandas as pd
# датасет pur_time от англ. purchase time, «время покупки»
pur_time = pd.Series([36, 44, 73, 32, 44, 29, 63, 60, 55, 74, 61, 26, 76, 40, 39, 28, 69, 61, 54, 58, 47, 41, 70, 51, 58, 36, 71, 47, 74, 59, 50, 78, 59, 48, 67, 53, 67, 52, 38, 55, 53, 53, 43, 77, 44, 63, 63, 54])
pur_time.hist(bins=[15, 35, 55, 75, 90], alpha=0.5)
pur_time.hist(bins=[15, 45, 55, 90], alpha=0.5)

```

### [Урок 4. Гистограммы плотностей](https://practicum.yandex.ru/trainer/data-scientist/lesson/aba0455f-45da-4376-bd50-6914ddd48ca6/)

Для непрерывных переменных нужен особый способ: учитывающий как интервалы, так и частоту попадания значений. Можно отображать частоту не _высотой_ столбца, а его _площадью_.
Площадь такого столбца находят, как площадь прямоугольника: длину интервала умножают на высоту столбца. Найденная площадь — частота непрерывной переменной, а высота столбца — **плотность частоты**.
!! Рассчитать плотность частоты попадания значений в интервал можно поделив частоту интервала на его ширину. (Площадь прямоугольника — высота, помноженная на ширину. Значит, высота — это площадь, делённая на ширину).
Гистограмма, построенная таким образом, называется **плотностная гистограмма.**
Берут два значения и ищут площадь плотностной гистограммы между ними. Полученное число и будет оценкой количества значений, попавших в интервал.

Гистограмма плотностей для времени (в минутах), которое потребовалось пользователям, чтобы зарегистрироваться на сайте знакомств:
![density|320x240](https://pictures.s3.yandex.net/resources/__1564078115.jpg)
Примерное значение количества пользователей, для которых регистрация заняла более 20 минут = 80. Сложим площади двух прямоугольников: одного — с шириной от 20 до 25, и высотой 10; второго — с шириной от 25 до 40, и высотой 2. (25 - 20) * 10 + (40 - 25) * 2 = 80.
Плотность частоты для непрерывных переменных можно задавать и кривыми функциями. Площадь между двумя значениями пропорциональна частоте попадания значений в интервал между ними.

### Урок 6. Характеристики положения
Характерные значениямя выборки - **характеристики положения данных:** по медиане и среднему можно судить, _где_ примерно расположен набор данных на числовой оси.
Среднее называют **алгебраическая характеристика положения.** 
Медиана — **структурная характеристика положения.**

### Урок 7. Разброс данных

У структурной характеристики положения — медианы — есть структурные метрики разброса: квартили.
Разброс значений вокруг алгебраической характеристики — среднего. Найти среднее расстояние между средним и всеми остальными значениями величины.
#### Урок 7. Задача
```python
import pandas as pd
data = pd.Series([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
mean_value = data.mean() # допишите ваш код здесь: найдите среднее значение в датасете
#print(mean_value)
spacing_all = data-mean_value  # допишите ваш код здесь: для каждого элемента датасета находим расстояние до среднего значения
spacing_all_mean = spacing_all.mean() # допишите ваш код здесь: считаем среднее расстояние
print(spacing_all_mean)

out: 0
```

### Урок 8. Дисперсия
Если складывать расстояния от среднего до значений больше него с расстояниями от среднего до значений меньше него. Одни получились положительными, другие — отрицательными. В итоге ноль.
Улучшенная метрика разброса — не просто среднее расстояние между значениями датасета и средним, а средний квадрат этого расстояния. Эта величина называется **дисперсия** (лат. _dispersio,_ «рассеяние»), её находят по формуле: \sigma^{2} = \frac{\sum \left ( \mu - x_{i} \right )^{2}}{n}σ2=n∑(μ−xi​)2​
![[Pasted image 20220930193830.png]]
Дисперсия обозначается как строчная сигма (σ) в квадрате, потому что в числителе дроби — квадраты разностей. Сигма - «стандартный»: квадратный корень из дисперсии — это стандартное отклонение.
Вместо возведения в квадрат разницы между значениями и средним одной переменной, можно перемножить такие разницы для двух переменных и получить ковариацию — характеристику линейной зависимости — между ними:
Co-variance = \frac{\sum \left (\overline{x} - x_{i})(\overline{y} - y_{i} \right )}{n}Co−variance=n∑(x−xi​)(y​−yi​)​
![[Pasted image 20220930194458.png]]
Если **нормировать** это выражение — избавиться от конкретных единиц измерения, поделив вместо _n_ на корень из произведения квадратов разниц для _x_ и для _y_ — получим **коэффициент корреляции Пирсона**.
Греческая буква мю (_μ)_ обозначает среднее арифметическое значение всего датасета:
μ=n∑(xi​​)/ n
Но есть ещё одна формула для дисперсии: s2 = ∑(μ − xi​)2​/ n−1
В датасете могут содержаться все доступные для наблюдения значения интересующей переменной. Например, вы исследуете цену поездок на Такси в 2019 году, и у вас есть датасет с ценой вообще всех поездок в этом году. Такой набор данных называется **генеральной совокупностью** (или просто, **совокупностью**). Если он есть в нашем распоряжении — можно вычислить дисперсию совокупности.
Но генеральная совокупность доступна аналитику не всегда. Бывает, что получить все данные слишком долго и дорого, или данные есть, но они настолько большие, что нужен суперкомпьютер, чтобы обработать их за разумное время. В таком случае можно взять выборку (чаще всего случайную) и оценить дисперсию всей совокупности по ней. Формула будет почти такой же, разница только в том, что в знаменателе надо вычесть единицу: 
s2=∑(μ−xi​)2​/ n−1
Характеристики, которые мы можем рассчитать, пользуясь только данными из выборки, называются **статистиками**. Да, статистика — перегруженный термин: не только название математической дисциплины, но и что-то, что можно посчитать, обладая только данными выборки. Статистики принято обозначать строчными латинскими буквами.
Можно доказать, что статистика _s²_, посчитанная на случайной выборке из некоторой генеральной совокупности по формуле выше с `n - 1` в знаменателе, — это **несмещённая оценка** для дисперсии этой генеральной совокупности. Иными словами, если мы возьмём из этой совокупности много случайных выборок определённого размера и посчитаем для них _s²_, среднее этих _s²_ будет стремиться к дисперсии всей совокупности — _σ²._ Чем больше взяли выборок и чем больше их размер — тем точнее. А если возьмём все возможные выборки этого размера — среднее их _s²_ будет в точности равно _σ²._
Чтобы посчитать дисперсию в python, в ход идёт библиотека **Numpy**. В то время как _Pandas_ хорош в структурах, _Numpy_ отвечает за высокоуровневые математические функции.
Дисперсию совокупности рассчитывают методом **`var()`** (от англ. _variance —_ «дисперсия»):
```python
import numpy as np 
x = [1, 2, 3, 4, 5, 6] # совокупность 
variance = np.var(x) 
print(variance)
out: 2.9166666666666665
```
Если известно, что датасет — не вся совокупность, а выборка из неё, вместо дисперсии считают её оценку по имеющейся выборке (то есть _s²_, а не _σ²_). Для этого в методе **var()** указывают параметр **ddof=1** ```
```python
variance_estimate = np.var(x, ddof=1) print(variance_estimate)
out: 3.5
```
Если все значения равны, все расстояния от среднего до значений будут нулевыми, а значит и сумма их квадратов тоже. Во всех остальных случаях хоть маленькая ненулевая дисперсия, да будет.

### Урок 9. Стандартное отклонение
Чтобы вернуться к изначальным единицам, из дисперсии извлекают квадратный корень. Полученное значение называется стандартное отклонение. Эта характеристика разброса появляется в результатах работы метода `describe()`. Обычно в качестве меры разброса рассчитывают именно стандартное отклонение, ведь оно измеряется в тех же единицах, что и сами данные.
стандартное отклонение обозначают сигмой **σ**
Стандартное отклонение находят методом `std()` (от англ. _standard deviation_, «стандартное отклонение») из библиотеки NumPy:
```python
import numpy as np
x = [1, 2, 3, 4, 5, 6]  # совокупность
standard_deviation = np.std(x)
print(standard_deviation) 

out: 1.707825127659933 
```
или 
```python
import numpy as np 
variance = 2.9166666666666665 
standard_deviation = np.sqrt(variance) 
print(standard_deviation)
```

#### Правило трёх сигм
Для нормальных распределений верно правило трёх стандартных отклонений, или правило трёх сигм. Оно гласит: практически все значения (около 99%) находятся в промежутке
**(μ−3σ,μ+3σ)**.
![density|320x240](https://pictures.s3.yandex.net/resources/__1586981654.jpg)
Это правило позволяет не только находить интервал, куда наверняка попадут практически все значения интересующей нас переменной, но и искать значения вне этого интервала. Их называют выбросами. На них полезно обратить внимание: само наличие выбросов может дать важную информацию об исследуемой переменной или указать на ошибки в её измерении.

#### Урок 9. Задачи
```python
import pandas as pd
import numpy as np

data = pd.Series([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
variance = np.var(data)# здесь посчитайте дисперсию
print(variance)
variance_estimate = np.var(data, ddof=1)# здесь посчитайте дисперсию
print(variance_estimate)
standard_dev=np.std(data,ddof=1)
print(standard_dev)
```

4. В среднем пользователи разглядывают всплывающие сообщения на сайте 3 секунды. Дисперсия равна 0,25 секунд в квадрате. По правилу трёх сигм рассчитайте, сколько времени нужно показывать сообщение, чтобы его успело разглядеть 99% пользователей.

```python
import numpy as np
adv_mean = 3; adv_var = 0.25

# рассчитайте стандартное отклонение
adv_std = np.sqrt(adv_var) 

# рассчитайте время показа пользователю всплывающего сообщения
adv_time = adv_mean + 3*adv_std

print('Время показа сообщения',adv_time)
```

### Урок 10. Скошенность наборов данных
Датасеты могут быть ассиметричными, то есть иметь **скошенность** в положительную или отрицательную сторону.
Определить скошенность легко по гистограмме. Для этого нужно представить асимметричную гистограмму как симметричную с «дополнительными» значениями.
![asimetric|240x180](https://pictures.s3.yandex.net/resources/______1564086121.jpg)
Гистограмма с _дополнительными значениями справа_ отображает частоту значений в **скошенном вправо наборе данных.** Его также называют датасетом **с положительной скошенностью**, ведь дополнительные значения находятся со стороны положительного направления оси.

Диаграмма размаха тоже хорошо иллюстрирует скошенность данных.
![asimetric|640x240](https://pictures.s3.yandex.net/resources/Untitled_1564086294.png)
медиана в отличие от среднего устойчива к выбросам, легко сделать вывод, что для скошенных вправо данных медиана будет меньше среднего, а для скошенных влево — больше.
Диаграмма размаха даёт больше информации о скошенности, на ней видны первый и третий квартили.


Чтобы ничего не забыть, скачайте [шпаргалку](https://code.s3.yandex.net/data-analyst/conspects/praktikum_data_analysis_takeaways_course4_theme1.pdf) и [конспект](https://code.s3.yandex.net/data-analyst/conspects/praktikum_data_analysis_abstract_course4_theme1.pdf) темы.

### Где ещё почитать про описательную статистику:

[Математическое ожидание и дисперсия случайной величины](https://function-x.ru/probabilities_expectation_dispersion.html)

[Как вычислить математическое ожидание?](http://www.mathprofi.ru/matematicheskoe_ozhidanie_i_dispersiya_nsv.html)

[Электронный учебник по статистике](http://statsoft.ru/home/textbook/default.htm)

