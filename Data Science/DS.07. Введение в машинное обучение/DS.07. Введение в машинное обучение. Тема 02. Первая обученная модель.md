**Обучающий (тренировочный) набор данных (обучающая выборка)** - набор данных, на котором будет обучаться алгоритм машинного обучения 
**Объекты** наблюдения - строки в наборе данных 
**Признаки** - переменные, столбцы в наборе данных 
**Целевой признак** -  признак, который нужно предсказать
**Обучение с учителем** - класс задач, в котором по обучающему набору данных (с известными значениями целевого показателя) нужно натренировать модель, предсказывающую для новых данных значения целевого признака 
**Классификация** - подзадача обучения с учителем, в которой целевой признак - категориальный 
**Бинарная классификация** - классификация, в котрой у целевого признака только две категории 
**Регрессия** - подзадача обучения с учителем, в которой целевой признак - количественный


## [Тема 02. Первая обученная модель](https://practicum.yandex.ru/learn/data-scientist/courses/581a9efe-e6df-4767-b5de-3ca913685a70/sprints/43496/topics/5d94a3c8-6dba-429d-b62b-39bfb219a8d1/lessons/366a37fe-120b-4dd3-b29d-3dc7eb775059/)

Мы поставим бизнес-задачу, а вы, чтобы её решить, сами обучите модель.
-   Изучите базовые понятия машинного обучения.
-   Узнаете, что такое «обучение с учителем» и какие бывают типы задач.
-   Познакомитесь с библиотекой scikit-learn.
-   Обучите первую модель.
Обращаясь к онлайн-сервисам по продаже недвижимости, покупатели хотят сэкономить; собственники — выгодно продать; а сам сайт объявлений — заработать. (Хотя бы немного.) Один такой сервис обнаружил, что продавцы указывают несоответствующие рынку цены. Можно ли избавиться от «человеческого фактора» и определить стоимость объекта автоматически, применив машинное обучение? 

### Урок 2  Постановка бизнес-задачи
Аналитики сайта выяснили: зачастую собственники указывают несоответствующие рынку цены, что уменьшает прибыль сервиса. Дешёвые предложения уходят быстро и дают меньшую комиссию, а дорогие — совсем не продаются. Как сделать так, чтобы одни собственники понимали, что продешевили, а другие, наоборот, — сильно переоценили жильё? Нужно разработать алгоритм, который подскажет продавцу лучшую цену.
-   умножать площадь квартиры на среднюю стоимость квадратного метра в городе;
-   уменьшать стоимость на 20%, если ремонту больше трёх лет;
-   увеличивать цену на 30%, если метро рядом с домом.

### Урок 3 Обучающий набор данных
Так же, как учились сами эксперты. Собирали базу знаний, классифицировали её, выявляли взаимосвязи и набирались опыта. Нам тоже нужно накопить подобную базу, на которой и будет обучаться компьютер. Она называется **обучающим (тренировочным) набором данных,** или **обучающей выборкой.**

Обучающая выборка в нашей задаче — набор данных от Яндекс.Недвижимости. Вы уже работали с ним на курсе «Исследовательский анализ данных». Мы немного изменили датасет: удалили мало влияющие на цену переменные, пропуски и квартиры вне города. Файл с данными назвали `train_data.csv` (от англ. _training data_, «тренировочные данные»)
```
import pandas as pd

df = pd.read_csv('train_data.csv')

print(df.shape)
print(df.head(5))
```
-   `last_price` — цена на момент снятия с публикации
-   `total_area` — площадь квартиры в квадратных метрах (м²)
-   `rooms` — число комнат
-   `ceiling_height` — высота потолков (м)
-   `floors_total` — всего этажей в доме
-   `living_area` — жилая площадь (м²)
-   `floor` — этаж
-   `is_apartment` — апартаменты (булев тип)
-   `studio` — квартира-студия (булев тип)
-   `open_plan` — свободная планировка (булев тип)
-   `kitchen_area` — площадь кухни (м²)
-   `balcony` — число балконов
-   `airports_nearest` — расстояние до ближайшего аэропорта в метрах (м)
-   `cityCenters_nearest` — расстояние до центра города (м)
![image|320](https://pictures.s3.yandex.net/resources/priznak-78796872-746d-4787-82d6-d8da271141c1_1570643426.jpg)

### [Урок 4 Обучение с учителем](https://practicum.yandex.ru/learn/data-scientist/courses/581a9efe-e6df-4767-b5de-3ca913685a70/sprints/43496/topics/5d94a3c8-6dba-429d-b62b-39bfb219a8d1/lessons/cfc495e3-1571-4f98-847d-fce5ad996ba3/)
В вашем распоряжении обучающий набор данных и **целевой признак**, который нужно предсказать **по остальным признакам**, — цена продажи жилья. Такие задачи относятся к классу **«обучение с учителем»** (от англ. _supervised learning_). «Учитель» ставит **вопросы** (признаки) и указывает **ответы** (целевой признак). И ничего не объясняет. Не просто так машины устраивают восстания в фильмах: им вправду тяжело.
Обучение с учителем подходит для решения многих бизнес-задач, поэтому бо́льшую часть программы посвятим именно ему. Позже рассмотрим и другие типы:
-   **обучение без учителя** (от англ. _unsupervised learning_) — без целевого признака;
-   **частичное обучение** — целевой признак известен только для части обучающих данных;
-   **рекомендации** — вместо признаков и объектов есть пользователи и товары (то, что можно рекомендовать; например, фильмы или район покупки квартиры).
задачи относятся к **обучению с учителем**:
- По содержанию сайта и истории кликов определить, перейдёт пользователь по рекламному баннеру или нет.
Содержание сайта относится к **признакам**; кликнул/не кликнул — это **целевой признак**; история кликов — **обучающий набор данных**. Всё понятно. Машина скажет спасибо.
- Выяснить возраст пользователя на основе его покупок. В вашем распоряжении история заказов других клиентов, чей возраст известен.
Список покупок относится к **признакам**; возраст — это **целевой признак**; история заказов других пользователей — **обучающий набор данных**.
«Так уж и быть. Оставь одежду, сапоги и мотоцикл себе», — ответила машина.
Выясним, какие подзадачи есть у обучения с учителем.
Напомним, что все переменные и признаки бывают двух типов: категориальные и количественные. Целевой признак не исключение.
Если целевой признак категориальный, то решается задача **классификации** (например, определить на изображении животное). Когда категорий всего две — допустим, вернётся или нет в интернет-магазин клиент — речь идёт о **бинарной (двоичной) классификации**.
Целевой признак количественный? Это задача **регрессии** — по данным восстанавливается зависимость между переменными. Так можно предсказать количество репостов новости или объём продаж интернет-магазина на ближайший месяц.

### [Урок 5 Классификация и регрессия](https://practicum.yandex.ru/learn/data-scientist/courses/581a9efe-e6df-4767-b5de-3ca913685a70/sprints/43496/topics/5d94a3c8-6dba-429d-b62b-39bfb219a8d1/lessons/3622729a-117a-4815-b10f-ffee8bf4261e/)
Знакомиться с машинным обучением на примере регрессии неудобно: расчёты будут слишком громоздкими из-за множества вариантов ответов (любое число). Легче, когда вариантов только два, как в бинарной классификации. Поэтому сначала разобьём все цены на «высокие» и «низкие» и предскажем, к какому классу относится жильё. А потом вернёмся к регрессии.
```python
import pandas as pd
df = pd.read_csv('train_data.csv')
print(df['last_price'].median()) 
```

```
5650000.0 
```

#### Урок 5. Задача 1
Преобразуйте исходную задачу в задачу классификации. Создайте новый признак _price_class_ (англ. «ценовой класс»). Чтобы установить его значение, сравните цену с 5 650 000:
-   если цена больше, значение _price_class_ — единица, `1.0`;
-   если цена меньше или равна, значение _price_class_ — ноль, `0.0`.

```python
import pandas as pd

df = pd.read_csv('/datasets/train_data.csv')
medians = df.last_price.median()

def app_price_class(price):
    if price <= medians:
        return 0
    else: 
        return 1

df['price_class'] = df['last_price'].apply(app_price_class).astype(float)        

print(df.head())
```

#### Урок 5. Задача 1
Многие библиотеки машинного обучения требуют, чтобы признаки были сохранены в отдельных переменных. Объявите две переменные:
-   `features` (англ. «признаки») — запишите в неё признаки;
-   `target` (англ. «цель») — целевой признак.
Выведите на экран размеры этих переменных (уже в прекоде).
**Подсказка**
Признаки — это все столбцы, кроме `last_price` и `price_class`. А `price_class` — это целевой признак. Столбец `last_price` больше не нужен.
```python
import pandas as pd
df = pd.read_csv('/datasets/train_data.csv')
df.loc[df['last_price'] > 5650000, 'price_class'] = 1
df.loc[df['last_price'] <= 5650000, 'price_class'] = 0

features = df.loc[:,'total_area':'cityCenters_nearest'] #
target = df['price_class'] #

print(features.shape)
print(target.shape)
```

### [Урок 6 Модели и алгоритмы](https://practicum.yandex.ru/trainer/data-scientist/lesson/773f01be-18af-485a-a2e7-c33f0c8735a5//)
Чтобы делать предсказания, нужно понимать взаимосвязи признаков и ответов. Что делает специалист по Data Science? Он выдвигает предположение, как устроены эти взаимосвязи. А на его основании делает предсказания. Если они совпадают с реальностью, значит, предположение верное. Этот подход называется **моделированием**, а сами предположения и способы предсказания — **моделями машинного обучения.**
Рассмотрим одну популярную модель — **решающее дерево**. Оно может описывать процесс принятия решения почти в любой ситуации. Например, поедет ли Ваня в отпуск в Иваново или дадут ли Юле кредит на покупку автомобиля _Alfa Romeo Giulietta._ Проверяем условия. Есть ли у Вани деньги? Нашёл он няню для котика или нет? Если условия выполнены, то — поедет. С Юлей не всё так просто. Ей меньше 18 лет: в кредите точно откажут. Так выстраивается дерево с ответами «Да»/«Нет» и различными вариантами действий.
![image|480](https://pictures.s3.yandex.net/resources/otpusk-c5ae3e37-5d49-4cd5-93f1-38188e12992e_1570654192.jpg)
- Обученная модель и алгоритм обучения — это программы.
В машинном обучении программы пишут программы. А люди тоже пишут... письма и алгоритмы, чтобы не получать спам:)
После обучения модель готова **предсказывать**.
!! Важно запомнить: процесс машинного обучения делится на два этапа — обучение модели и работа этой модели.
- Чтобы продукт хорошо работал, нужно выбрать подходящий алгоритм обучения.
Предсказывает модель, а обучают её алгоритмы. Неудачно выбранный алгоритм = неработающая модель.
Обученная модель не работает напрямую с обучающим набором данных. Скорее всего, медленным будет само о-бу-че-ни-е.

### [Урок 7 Библиотека scikit-learn](https://practicum.yandex.ru/trainer/data-scientist/lesson/3262f7cf-1326-4874-b837-f67ab9bb3efe/task/bb2c6bdb-acbf-4714-8a9a-33128006f470/)
Познакомимся с чёрным ящиком, новой библиотекой и перейдём к программированию.
Алгоритмы обучения чаще устроены сложнее, чем сама модель. Поэтому представьте их чёрными ящиками: пока неважно, что происходит внутри. Главное понять, что именно положить в ящик и как работать с тем, что он выдаст.
Концепцию чёрного ящика можно сравнить с заказом пиццы онлайн. Чтобы её купить, нужно разобраться, как устроен сервис, выбрать ингредиенты и указать адрес доставки. А когда надумаете открыть собственную пиццерию «Папа Иван», узнаете, как эту пиццу готовить и доставлять
Но где взять чёрный ящик? В библиотеках Python уже доступны многие алгоритмы. Этот урок посвятим одной популярной библиотеке — `scikit-learn`, или `sklearn` (от англ. _scientific kit for learning,_ «научный набор для обучения»).
В _sklearn_ много инструментов работы с данными и моделей, поэтому они разложены по подразделам. В модуле `tree` (англ. «дерево») находится решающее дерево.
Каждой модели в _sklearn_ соответствует отдельная структура данных. `DecisionTreeClassifier` (англ. «классификатор дерева решений») — это структура данных для классификации деревом решений.
Затем создаём объект этой структуры данных. Получение структуры данных для классификации деревом решений:
```python
from sklearn.tree import DecisionTreeClassifier 

model = DecisionTreeClassifier() 
```
В переменной _model_ (англ. «модель») будет храниться модель. Наша модель пока не умеет предсказывать. Чтобы она научилась, нужно запустить алгоритм обучения.

#### Урок 7. Задача 1
Начните с обучения модели. В пятом уроке вы сохранили обучающий набор данных в переменных `features` и `target`. Чтобы запустить обучение, вызовите метод `fit()` (англ. «подогнать») и передайте ему как параметр данные.
Допишите код. Выведите значение переменной на экран (уже сделано в прекоде).
```python
import pandas as pd
from sklearn.tree import DecisionTreeClassifier # импорт решающего дерево из библиотеки sklearn

df = pd.read_csv('/datasets/train_data.csv')
df.loc[df['last_price'] > 5650000, 'price_class'] = 1
df.loc[df['last_price'] <= 5650000, 'price_class'] = 0

features = df.drop(['last_price', 'price_class'], axis=1)
target = df['price_class']

model = DecisionTreeClassifier() # создание пустой модели
model.fit(features,target) # обучите модель вызовом метода fit()

print(model)
```

Страшно? Не волнуйтесь, всё работает: модель обучена. Просто в библиотеке _sklearn_ её нельзя вывести на экран. Но можно посмотреть возможные параметры алгоритма обучения:
```PYTHON
DecisionTreeClassifier(class_weight=None, criterion='gini', max_depth=None,
max_features=None, max_leaf_nodes=None,
min_impurity_decrease=0.0, min_impurity_split=None,
min_samples_leaf=1, min_samples_split=2, splitter='best') 
```

Да, это чёрный ящик, но ради интереса немного его «расшифруем»:
-   `class_weight=None` — у классов одинаковый вес (равнозначны).
-   `max_features=None` — количество признаков, необходимых для одного ветвления. Можно указать конкретное число или процент признаков.
-   `max_depth=None` — глубина дерева не ограничена.

#### Урок 7. Задача 2
Теперь в переменной `model` полноценная модель. Чтобы предсказать ответы, нужно вызвать метод `predict()` (англ. «предсказать») и передать ему таблицу с признаками новых объектов.
```PYTHON
answers = model.predict(new_features) 
```
Создайте два новых объекта и посмотрите на результаты предсказаний. Объекты задачи — это дома. Выпишите значения признаков каждого:

1.  В первой квартире целых 12 комнат общей площадью 900 кв. м. Из них жилых 409.7 кв. м, а кухня — 112 кв. м.
2.  Во второй квартире 2 комнаты общей площадью 109 кв. м. Из них жилых 32 кв. м, а кухня — 40.5 кв. м.
Остальные признаки не различаются или разнятся не так сильно. Их мы уже заполнили в прекоде. Предскажите ответ и напечатайте результат на экране.

```python
import pandas as pd
from sklearn.tree import DecisionTreeClassifier

df = pd.read_csv('/datasets/train_data.csv')
df.loc[df['last_price'] > 5650000, 'price_class'] = 1
df.loc[df['last_price'] <= 5650000, 'price_class'] = 0

features = df.drop(['last_price', 'price_class'], axis=1)
target = df['price_class']
model = DecisionTreeClassifier()

model.fit(features, target)

new_features = pd.DataFrame(
    [[None, None, 2.8, 25, None, 25, 0, 0, 0, None, 0, 30706.0, 7877.0],
     [None, None, 2.75, 25, None, 25, 0, 0, 0, None, 0, 36421.0, 9176.0]],
    columns=features.columns)

new_features.loc[0, ['total_area','rooms','living_area','kitchen_area']] = [900.0, 12, 409.7, 112]
new_features.loc[1, ['total_area','rooms','living_area','kitchen_area']] = [109.0, 2, 32,40.5] 
    
"""# дозаполните таблицу с новыми признаками
new_features.loc[0, 'total_area'] = 900.0
# < напишите код здесь >
new_features.loc[0, 'rooms'] = 12 
new_features.loc[0, 'living_area'] = 409.7
new_features.loc[0, 'kitchen_area'] = 112

new_features.loc[1, 'total_area'] = 109.0
new_features.loc[1, 'rooms'] = 2 
new_features.loc[1, 'living_area'] = 32
new_features.loc[1, 'kitchen_area'] = 40.5"""

# предскажите ответы и напечатайте результат на экране
answers = model.predict(new_features)
print(answers)
```

### [Урок 8 Схема машинного обучения](https://practicum.yandex.ru/trainer/data-scientist/lesson/006f2499-7343-43cc-a516-47eb35dff452/)
![image|480](https://pictures.s3.yandex.net/resources/process_2-d1aaa547-6a6a-482f-b894-946919258386_1570655091.jpg)
**Что получили:
-   Обучающий набор данных сохранён в переменных `features` (признаки) и `target` (целевой признак).
-   Признаки новых объектов записаны в переменной `new_features`. Нужно найти целевой признак.
-   Обучение выполняется методом `fit()`, а предсказание — `predict()`.
-   Модель сохранена в переменной `model`. Она и обучается, и предсказывает.

### [Урок 9 Отображение моделей](https://practicum.yandex.ru/trainer/data-scientist/lesson/6520070f-5c9f-4f43-80d4-04e7ff24058e/)
Узнаем, как выглядит обученная модель и что скрывается внутри неё.
Вы догадывались, что в модели пара тысяч строк такого текста?!
```python
|--- total_area <= 60.75
|   |--- total_area <= 46.36
|   |   |--- cityCenters_nearest <= 7959.50
|   |   |   |--- kitchen_area <= 8.10
|   |   |   |   |--- living_area <= 21.45
|   |   |   |   |   |--- living_area <= 12.50
|   |   |   |   |   |   |--- kitchen_area <= 7.50
|   |   |   |   |   |   |   |--- class: 0.0
|   |   |   |   |   |   |--- kitchen_area >  7.50
|   |   |   |   |   |   |   |--- class: 1.0
|   |   |   |   |   |--- living_area >  12.50
|   |   |   |   |   |   |--- total_area <= 33.75
...
```
Получить понятные модели или осмыслить неочевидные (к примеру, такое решающее дерево) — помогут специальные алгоритмы. Вот что выходит:
```
|--- total_area <= 60.75
|   |--- total_area <= 46.36
|   |   |--- class: 0.0
|   |--- total_area >  46.36
|   |   |--- ceiling_height <= 2.69
|   |   |   |--- class: 0.0
|   |   |--- ceiling_height >  2.69
|   |   |   |--- class: 1.0
|--- total_area >  60.75
|   |--- class: 1.0
```
В Python это же самое будет выглядеть так:

```PYTHON
if features['total_area'] <= 60.75:
    if features['total_area'] <= 46.36:
        answer = 0
    else:
        if features['ceiling_height'] <= 2.69:
            answer = 0
        else:
            answer = 1
else:
    answer = 1 
```
А так — в виде схемы:
![image|640](https://pictures.s3.yandex.net/resources/total_area-c6e6f933-8474-48a9-a553-9e9cf8a1f51b_1570655202.jpg)
Какие странные условия получились! Но у компьютера нет цели выводить красивые числа.
Возможность заглянуть внутрь модели и понять, как решается задача, бывает критически важна, когда дело касается людей. Например, в диагностике заболеваний или анализе анкет, чтобы исключить дискриминацию при трудоустройстве. Но для задач бизнеса делать модель «прозрачной» необязательно. Главное, чтобы она работала.

— когда можно использовать машинное обучение;
— какие задачи оно решает;
— как отличить регрессию от классификации;
— что такое модели и алгоритмы их обучения.

### Заберите с собой
Чтобы ничего не забыть, [скачайте шпаргалку](https://code.s3.yandex.net/data-analyst/conspects/praktikum_data_scientist_takeaways_course6_theme2.pdf) и [конспект темы](https://code.s3.yandex.net/data-analyst/conspects/praktikum_data_scientist_abstract_course6_theme2.pdf).
